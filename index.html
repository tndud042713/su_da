<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ’• ìˆ˜ë‹¤ ìœ„ì‹œë¦¬ìŠ¤íŠ¸</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #ffeef8 0%, #ffe5f5 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 30px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(255, 105, 180, 0.2);
        }

        h1 {
            text-align: center;
            color: #ff1493;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(255, 105, 180, 0.3);
        }

        .subtitle {
            text-align: center;
            color: #ff69b4;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .progress-container {
            margin: 30px 0;
            text-align: center;
        }

        .progress-stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #ff1493;
        }

        .stat-label {
            color: #888;
            font-size: 0.9em;
        }

        .progress-bar-bg {
            background: #ffe5f5;
            border-radius: 20px;
            height: 30px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar {
            background: linear-gradient(90deg, #ff69b4, #ff1493);
            height: 100%;
            border-radius: 20px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .section {
            margin: 40px 0;
        }

        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: linear-gradient(135deg, #ffe5f5 0%, #fff 100%);
            border-radius: 15px;
        }

        .section-icon {
            font-size: 2em;
            margin-right: 15px;
        }

        .section-title {
            flex: 1;
            font-size: 1.5em;
            color: #ff1493;
            font-weight: bold;
        }

        .section-count {
            background: #ff69b4;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
        }

        .add-item-container {
            margin: 20px 0;
            display: flex;
            gap: 10px;
        }

        .add-input {
            flex: 1;
            padding: 12px;
            border: 2px solid #ffe5f5;
            border-radius: 10px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .add-input:focus {
            outline: none;
            border-color: #ff69b4;
        }

        .add-btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #ff69b4, #ff1493);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .add-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 105, 180, 0.3);
        }

        .checklist-item {
            display: flex;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            border-radius: 12px;
            background: white;
            border: 2px solid #ffe5f5;
            transition: all 0.3s;
        }

        .checklist-item:hover {
            border-color: #ff69b4;
            box-shadow: 0 5px 15px rgba(255, 105, 180, 0.15);
            transform: translateY(-2px);
        }

        .checklist-item.checked {
            background: #fff5f9;
            border-color: #ffb3d9;
        }

        .checklist-item.checked label {
            color: #999;
            text-decoration: line-through;
        }

        input[type="checkbox"] {
            width: 24px;
            height: 24px;
            margin-right: 15px;
            cursor: pointer;
            accent-color: #ff69b4;
        }

        label {
            flex: 1;
            cursor: pointer;
            font-size: 1.05em;
            color: #333;
            line-height: 1.5;
        }

        .delete-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.2em;
            transition: all 0.3s;
            margin-left: 10px;
        }

        .delete-btn:hover {
            background: #ff5252;
            transform: scale(1.1);
        }

        .footer {
            text-align: center;
            margin-top: 50px;
            padding: 30px;
            background: linear-gradient(135deg, #ffe5f5 0%, #fff 100%);
            border-radius: 20px;
            color: #ff69b4;
        }

        .footer-text {
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .footer-date {
            font-size: 1.5em;
            font-weight: bold;
            color: #ff1493;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #ff69b4;
            font-size: 1.2em;
        }

        @keyframes float-up {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) scale(0.5);
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            h1 {
                font-size: 1.8em;
            }
            .add-item-container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ’• ìˆ˜ë‹¤ ìœ„ì‹œë¦¬ìŠ¤íŠ¸ ğŸ’•</h1>
        <p class="subtitle">í•¨ê»˜ ë§Œë“¤ì–´ê°€ëŠ” ìš°ë¦¬ì˜ ë²„í‚·ë¦¬ìŠ¤íŠ¸</p>

        <div class="loading" id="loading">ë°ì´í„° ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘... ğŸ’«</div>

        <div id="mainContent" style="display: none;">
            <div class="progress-container">
                <div class="progress-stats">
                    <div class="stat">
                        <div class="stat-number" id="totalCount">0</div>
                        <div class="stat-label">ì „ì²´ ëª©í‘œ</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number" id="completedCount">0</div>
                        <div class="stat-label">ì™„ë£Œ</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number" id="remainingCount">0</div>
                        <div class="stat-label">ë‚¨ì€ ëª©í‘œ</div>
                    </div>
                </div>
                <div class="progress-bar-bg">
                    <div class="progress-bar" id="progressBar">0%</div>
                </div>
            </div>

            <!-- ìˆ˜ì˜ ì„¹ì…˜ -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">ğŸŠâ€â™€ï¸</span>
                    <h2 class="section-title">ìˆ˜ì˜ì˜ ìœ„ì‹œë¦¬ìŠ¤íŠ¸</h2>
                    <span class="section-count" id="suyoung-count">0/0</span>
                </div>
                
                <div class="add-item-container">
                    <input type="text" class="add-input" id="suyoung-input" 
                           placeholder="ìƒˆë¡œìš´ ìœ„ì‹œ ì¶”ê°€í•˜ê¸° ğŸ’­" 
                           onkeypress="if(event.key==='Enter') addItem('suyoung')">
                    <button class="add-btn" onclick="addItem('suyoung')">â• ì¶”ê°€</button>
                </div>
                
                <div id="suyoung-list"></div>
            </div>

            <!-- ë‹¤ìœ„ ì„¹ì…˜ -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">ğŸ®</span>
                    <h2 class="section-title">ë‹¤ìœ„ì˜ ìœ„ì‹œë¦¬ìŠ¤íŠ¸</h2>
                    <span class="section-count" id="dawi-count">0/0</span>
                </div>
                
                <div class="add-item-container">
                    <input type="text" class="add-input" id="dawi-input" 
                           placeholder="ìƒˆë¡œìš´ ìœ„ì‹œ ì¶”ê°€í•˜ê¸° ğŸ’­"
                           onkeypress="if(event.key==='Enter') addItem('dawi')">
                    <button class="add-btn" onclick="addItem('dawi')">â• ì¶”ê°€</button>
                </div>
                
                <div id="dawi-list"></div>
            </div>

            <div class="footer">
                <div class="footer-text">í•˜ë‚˜ ì´ë£¨ë©´ í•˜ë‚˜ì”© ì²´í¬í•´ì£¼ê¸° ğŸ’</div>
                <div class="footer-date">~ 2027ë…„ 10ì›”ê¹Œì§€ ~</div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, set, onValue, push, remove, update } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

        // â­ ì—¬ê¸°ì— Firebase Config ë¶™ì—¬ë„£ê¸°! â­
        const firebaseConfig = {
        apiKey: "AIzaSyAZP3IWLyTVgUUFuKgfpwOvks3al1i7mYs",
        authDomain: "couple-wishlist.firebaseapp.com",
        databaseURL: "https://couple-wishlist-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "couple-wishlist",
        storageBucket: "couple-wishlist.firebasestorage.app",
        messagingSenderId: "983076114841",
        appId: "1:983076114841:web:23e69de303e139f5f90308",
        measurementId: "G-FQ2HZHTB98"
      };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // ì „ì—­ í•¨ìˆ˜ ë…¸ì¶œ
        window.addItem = addItem;
        window.toggleItem = toggleItem;
        window.deleteItem = deleteItem;

        // ì´ˆê¸°í™”
        let suyoungData = {};
        let dawiData = {};

        window.onload = function() {
            initializeWishlist();
        };

        // ì´ˆê¸° ë°ì´í„° ì„¤ì • (í•œ ë²ˆë§Œ ì‹¤í–‰)
        function initializeWishlist() {
            const initialData = {
                suyoung: [
                    "ë“œë¼ì´ë¸Œ í•˜ê³  ê·¼êµ ë§›ì§‘ ê°€ê¸°(ex. ê°„ì¥ê²Œì¥)",
                    "ë‹¤ìœ„ë‚´ êµíšŒ ê°€ê¸°",
                    "ë‹¤ìœ„ë‘ ìŠ¤í‹°ì»¤ ì‚¬ì§„ ì°ê¸°",
                    "ë‹¤ìœ„ë‘ ë°”ë‹¤ ë†€ëŸ¬ê°€ê¸°",
                    "ë‚šì‹œ",
                    "ì—°ì°¨ë‚´ê³  ë‹¤ìœ„ë‘ í•˜ë£¨ì¢…ì¼ ê°™ì´ ì§€ë‚´ê¸°",
                    "ë¡¯ë°ì›”ë“œ ê°€ê¸°",
                    "í•©ì£¼í•˜ê¸°(íŠ¸ë¦¬ì˜¤ë‚˜ ë“€ì—£ìœ¼ë¡œ)",
                    "ë”ë¸” ë°ì´íŠ¸í•˜ê¸°(ë‚´ ë™ìƒì´ë‘)",
                    "ë°˜ì§€ê³µë°© ê°€ê¸°(ì›ë°ì´ í´ë˜ìŠ¤)",
                    "ë‹¤ìœ„ìŒ¤í•œí…Œ ì¿ í‚¤ ë§Œë“œëŠ”ê±° ë°°ìš°ê¸°",
                    "ë‹¤ìœ„í•œí…Œ ë„ì‹œë½ ë§Œë“¤ì–´ì£¼ê¸°",
                    "ë‹¤ìœ„í•œí…Œ ê¹œì§ ì„ ë¬¼í•˜ê¸°",
                    "ê°™ì´ ê²°í˜¼ì‹ì¥ ì•Œì•„ë³´ê¸°~(ë‚´ê°€ ê¿ˆì´ ê±°ì°½í•¨)",
                    "ë¶ˆì¥ë‚œ(ì€ì–´ì„)",
                    "ë‹´ë°° ëŠê¸°(ìˆ˜ì˜ í•œì •) - ë‹¤ì‹œëŠ” ì•ˆí”¼ê³  ì‹¶ì„ë§Œí¼",
                    "ë‹¤ìœ„ë„¤ ë™ë„¤ ë†€ëŸ¬ê°€ê¸° (í™”ì„±ì‹œ ë´‰ë‹´ì)",
                    "ë¹ ì§€ ê°€ì„œ ë°”ë‚˜ë‚˜ ë³´íŠ¸ íƒ€ê¸°~",
                    "ê²¨ìš¸ì— ì›Œí„°íŒŒí¬ ê°€ê¸° (ì˜¨ìˆ«ë¬¼ì´ë¼ ë”°ìˆ˜ì›€)",
                    "ã…ã„¹ã…ã…ˆ(ì•Œì˜ë”±ê¹ì„¼)",
                    "ì´ë²ˆë…„ë„ ê°€ê¸° ì „ì— ë°©ë„ëª¨ì„ ê°™ì´ ê°€ê¸°",
                    "ì˜ˆìˆ ì— ì „ë‹¹ì—ì„œ ì¢‹ì€ ê³µì—° ê°™ì´ ë³´ê¸°",
                    "ì• ê²¬ì¹´í˜ ê°™ì´ê°€ê¸°",
                    "ë‹¤ìœ„ ì˜· ê³¨ë¼ì£¼ê¸°(ì‡¼í•‘ëª° ê°™ì´ ê°€ì„œ)",
                    "ê°™ì´ ëŸ°ë‹ ë›°ê¸°",
                    "ê°™ì´ ë¯¸ì¹œì²™í•˜ê³  í•œë²ˆì€ ë†€ì•„ë³´ê¸°",
                    "ë‹¤ìœ„ ë„¤ì¼í•œë²ˆ í•´ì£¼ê¸°"
                ],
                dawi: [
                    "ì°œì§ˆë°© ê°€ê¸°",
                    "ìˆ˜ì˜ì´ë„¤ êµíšŒ ê°€ê¸°",
                    "ìˆ˜ì˜ì´ë‘ ì‚¬ë‘ë¶€ ìˆ˜ë ¨íšŒ ë´‰ì‚¬ê°€ê¸°",
                    "ë§Œí™”ì¹´í˜ ê°€ê¸°",
                    "ë“±ì‚°í•˜ê¸°",
                    "ê²½ì£¼ì›”ë“œ ê°€ê¸° (Full Course)",
                    "ìº í•‘ í•˜ëŸ¬ê°€ê¸°",
                    "ë”ë¸” ë°ì´íŠ¸í•˜ê¸°(ë‚´ ì¹­êµ¬ë‘)",
                    "ì»¤í”Œí‹° ë§ì¶”ê¸°",
                    "ë„ìê¸° ê³µë°©(ì›ë°ì´ í´ë˜ìŠ¤)",
                    "ìˆ˜ì˜ì´í•œí…Œ ë§›ìˆëŠ” ìŒì‹ ë§Œë“¤ì–´ì£¼ê¸°",
                    "ìˆ˜ì˜ì´í•œí…Œ ê¹œì§ ì„ ë¬¼í•˜ê¸°",
                    "ë°¤ìƒˆ ë†€ê¸°(ë‚ ë°¤ê¹Œê¸°)",
                    "ë§ˆì‚¬ì§€ ë°›ìœ¼ëŸ¬ ê°€ê¸°",
                    "ë°”ë‹¤ ìˆ˜ì˜ í•˜ê¸°",
                    "ìˆ˜ì˜ì´ ìš´ì „ê¸°ì‚¬ í•´ì£¼ê¸° (í—... ê°ë™)",
                    "ìŠ¤í‚¤ì¥ ê°€ê¸°",
                    "ì¼ë³¸ ì˜¨ì²œê°€ê¸°",
                    "í˜¸ì„¸ë‘ ê°™ì´ ë†€ê¸°",
                    "ë² ë“œë¯¼í„´ ê°™ì´ ì¹˜ê¸°",
                    "ê³µí¬ì˜í™” ê°™ì´ë³´ê¸°",
                    "ë®¤ì§€ì»¬ ë³´ëŸ¬ê°€ê¸°",
                    "ì¬ì¦ˆ bar ê°€ê¸°",
                    "ìˆ˜ì˜ ì˜· ê³¨ë¼ì£¼ê¸°(ì‡¼í•‘ëª° ê°™ì´ ê°€ì„œ) - ì´í•˜ë™ë¬¸",
                    "ê¸°ë…ì¼ë‚  ë˜‘ê°™ì€ ì§€ì—­ì„ ì¡ì•„ì„œ ê¸°ë…ì¼ë§ˆë‹¤ ì‚¬ì§„ ì°ê¸°(ë¦´ìŠ¤ì— ìì£¼ ë‚˜ì˜¤ëŠ”ê±°)",
                    "ê°™ì´ ë¨¸ë¦¬í•˜ëŸ¬ ê°€ê¸°",
                    "ì†í¸ì§€ ì“°ê¸°(ì„œë¡œ)",
                    "ì‹¸ì› ì„ë•Œë„ ì‚¬ë‘í•œë‹¤êµ¬ ë§í•´ì£¼ê¸°"
                ]
            };

            // ìˆ˜ì˜ ë¦¬ìŠ¤íŠ¸ ë¡œë“œ
            loadWishlist('suyoung', initialData.suyoung);
            // ë‹¤ìœ„ ë¦¬ìŠ¤íŠ¸ ë¡œë“œ
            loadWishlist('dawi', initialData.dawi);
        }

        // ìœ„ì‹œë¦¬ìŠ¤íŠ¸ ë¡œë“œ
        function loadWishlist(section, initialItems = []) {
            const wishlistRef = ref(database, `wishlist/${section}`);
            
            onValue(wishlistRef, (snapshot) => {
                const data = snapshot.val();
                const container = document.getElementById(`${section}-list`);
                container.innerHTML = '';
                
                // ë°ì´í„° ì €ì¥
                if (section === 'suyoung') suyoungData = data || {};
                else dawiData = data || {};
                
                if (data) {
                    // ìƒì„± ì‹œê°„ìˆœìœ¼ë¡œ ì •ë ¬
                    const sortedKeys = Object.keys(data).sort((a, b) => 
                        (data[a].createdAt || 0) - (data[b].createdAt || 0)
                    );
                    
                    sortedKeys.forEach(key => {
                        const item = data[key];
                        addItemToDOM(section, key, item.text, item.checked);
                    });
                } else if (initialItems.length > 0) {
                    // ì´ˆê¸° ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ í•­ëª© ì¶”ê°€
                    initialItems.forEach(text => {
                        const newItemRef = push(wishlistRef);
                        set(newItemRef, {
                            text: text,
                            checked: false,
                            createdAt: Date.now()
                        });
                    });
                }
                
                // ë¡œë”© ì™„ë£Œ
                document.getElementById('loading').style.display = 'none';
                document.getElementById('mainContent').style.display = 'block';
                
                updateStats();
            });
        }

        // DOMì— í•­ëª© ì¶”ê°€
        function addItemToDOM(section, id, text, checked) {
            const container = document.getElementById(`${section}-list`);
            const div = document.createElement('div');
            div.className = 'checklist-item' + (checked ? ' checked' : '');
            div.innerHTML = `
                <input type="checkbox" ${checked ? 'checked' : ''} 
                    onchange="toggleItem('${section}', '${id}')">
                <label onclick="toggleItem('${section}', '${id}')">${text}</label>
                <button class="delete-btn" onclick="deleteItem('${section}', '${id}')" 
                        title="ì‚­ì œ">ğŸ—‘ï¸</button>
            `;
            container.appendChild(div);
        }

        // ìƒˆ í•­ëª© ì¶”ê°€
        function addItem(section) {
            const input = document.getElementById(`${section}-input`);
            const text = input.value.trim();
            
            if (!text) {
                alert('ìœ„ì‹œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”! ğŸ’­');
                return;
            }
            
            const wishlistRef = ref(database, `wishlist/${section}`);
            const newItemRef = push(wishlistRef);
            
            set(newItemRef, {
                text: text,
                checked: false,
                createdAt: Date.now()
            }).then(() => {
                input.value = '';
                createHeartAnimation(event);
            }).catch((error) => {
                alert('ì¶”ê°€ ì‹¤íŒ¨: ' + error.message);
            });
        }

        // ì²´í¬ í† ê¸€
        function toggleItem(section, id) {
            const itemRef = ref(database, `wishlist/${section}/${id}`);
            const data = section === 'suyoung' ? suyoungData : dawiData;
            const item = data[id];
            
            if (item) {
                update(itemRef, {
                    checked: !item.checked
                }).then(() => {
                    createHeartAnimation(event);
                });
            }
        }

        // í•­ëª© ì‚­ì œ
        function deleteItem(section, id) {
            if (confirm('ì •ë§ ì‚­ì œí• ê¹Œìš”? ğŸ’”')) {
                const itemRef = ref(database, `wishlist/${section}/${id}`);
                remove(itemRef).catch((error) => {
                    alert('ì‚­ì œ ì‹¤íŒ¨: ' + error.message);
                });
            }
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats() {
            // ì „ì²´ í†µê³„
            const allCheckboxes = document.querySelectorAll('input[type="checkbox"]');
            const total = allCheckboxes.length;
            const completed = Array.from(allCheckboxes).filter(cb => cb.checked).length;
            
            document.getElementById('totalCount').textContent = total;
            document.getElementById('completedCount').textContent = completed;
            document.getElementById('remainingCount').textContent = total - completed;
            
            const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = percentage + '%';
            progressBar.textContent = percentage + '%';

            // ì„¹ì…˜ë³„ í†µê³„
            updateSectionCount('suyoung');
            updateSectionCount('dawi');
        }

        function updateSectionCount(section) {
            const container = document.getElementById(`${section}-list`);
            const checkboxes = container.querySelectorAll('input[type="checkbox"]');
            const total = checkboxes.length;
            const completed = Array.from(checkboxes).filter(cb => cb.checked).length;
            
            document.getElementById(`${section}-count`).textContent = `${completed}/${total}`;
        }

        // í•˜íŠ¸ ì• ë‹ˆë©”ì´ì…˜
        function createHeartAnimation(e) {
            if (!e || !e.clientX) return;
            
            const heart = document.createElement('div');
            heart.textContent = ['ğŸ’–', 'ğŸ’•', 'ğŸ’—', 'ğŸ’'][Math.floor(Math.random() * 4)];
            heart.style.cssText = `
                position: fixed;
                left: ${e.clientX}px;
                top: ${e.clientY}px;
                font-size: 2em;
                pointer-events: none;
                animation: float-up 2s ease-out forwards;
                z-index: 1000;
            `;
            document.body.appendChild(heart);
            
            setTimeout(() => heart.remove(), 2000);
        }
    </script>
</body>
</html>
